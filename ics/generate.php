<?phpfunction getformatingdate($date){	$tahun = $date[0].$date[1].$date[2].$date[3];	$bulan = $date[4].$date[5];	$tanggal = $date[6].$date[7];	return $tahun."-".$bulan."-".$tanggal;}function getrealdate($date){	return strtotime(getformatingdate($date));}require("../../config/database.php");require("../class/ics.php");require("../class/ics_unit.php");echo 'Memulai...';$ICS = new ICS('');$unit = new Ics_unit($db);$show = $unit->showUnit();while($data = $show->fetch(PDO::FETCH_OBJ)){	$kd_unit = $data->kd_unit;	date_default_timezone_set('Asia/Jakarta');	$sekarang = date('Y-m-d');	$current_trx = array();	$show2 = $unit->showRecent_trx($kd_unit, $sekarang);	while($data2 = $show2->fetch(PDO::FETCH_OBJ)){		$current_trx[] = $data2->check_in; 	}	$show2 = $unit->showRecent_booked($kd_unit, $sekarang);	while($data2 = $show2->fetch(PDO::FETCH_OBJ)){		$current_trx[] = $data2->check_in; 	}	$ICS->change_file($data->url_bnb);	$icsEvents = $ICS->cal_to_array();	for($i=0; $i<count($icsEvents); $i++){		$tmp_arr = $icsEvents[$i];		$check_in = getrealdate($tmp_arr['DTSTART;VALUE=DATE']);		$check_out = getrealdate($tmp_arr['DTEND;VALUE=DATE']);		if(!in_array(getformatingdate($tmp_arr['DTSTART;VALUE=DATE']), $current_trx) 			&& ($check_in>=strtotime($sekarang) || $check_out>=strtotime($sekarang))){			$kd_apt = $data->kd_apt;			$penyewa_id = explode(' ', $tmp_arr['SUMMARY']);			$penyewa = str_replace(" ".$penyewa_id[count($penyewa_id)-1], "", $tmp_arr['SUMMARY']);			if(isset($tmp_arr['PHONE'])){				$no_tlp = '';				$check_in = getformatingdate($tmp_arr['DTSTART;VALUE=DATE']); 				$check_out = getformatingdate($tmp_arr['DTEND;VALUE=DATE']); 				$unit->createBooked($kd_unit, $kd_apt, $penyewa, $no_tlp, $check_in, $check_out);				//echo $kd_unit."><".$kd_apt."><".$penyewa."><".$no_tlp."><".$check_in."><".$check_out."<br>";			}		}	}	}phpinfo();echo 'Selesai';?>